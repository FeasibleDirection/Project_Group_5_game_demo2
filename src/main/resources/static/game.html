<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Ground Attack - Game</title>
    <link rel="stylesheet" href="/css/game.css">
</head>
<body>
<div class="game-root">
    <header class="top-bar">
        <div class="top-left">
            <span id="lblRoom">Room ?</span>
            <span id="lblUser" class="user-name"></span>
            <span id="lblArchitecture" style="color: #8df59d; font-weight: bold;"></span>
        </div>
        <div class="top-middle">
            <span>HP: <span id="hpText"></span></span>
            <span>Score: <span id="scoreText"></span></span>
            <span>Time: <span id="timeText"></span></span>
        </div>
        <div class="top-right">
            <button id="btnLeave">Back to Lobby</button>
        </div>
    </header>

    <main class="game-main">
        <canvas id="gameCanvas" width="480" height="640"></canvas>

        <aside class="score-panel">
            <h3>Scoreboard</h3>
            <ul id="scoreList"></ul>
        </aside>
    </main>

    <div id="overlay" class="overlay hidden">
        <div class="overlay-card">
            <h2 id="overTitle">Game Over</h2>
            <p id="overSummary"></p>
            <button id="btnBackLobby">Return to Lobby</button>
        </div>
    </div>
</div>

<script src="/js/session.js"></script>
<script>
    // 根据URL参数动态加载对应架构的游戏逻辑
    const params = new URLSearchParams(window.location.search);
    const arch = params.get('arch') || 'A';
    
    if (arch === 'A') {
        // Architecture A: Server-Authoritative
        const script = document.createElement('script');
        script.src = '/js/game-architecture-a.js';
        document.body.appendChild(script);
    } else if (arch === 'B') {
        // Architecture B: P2P Lockstep (Host-based, via server relay)
        const script = document.createElement('script');
        script.src = '/js/game-architecture-b.js';
        document.body.appendChild(script);
    } else {
        // 默认使用原始本地游戏逻辑（废弃）
        const script = document.createElement('script');
        script.src = '/js/game.js';
        document.body.appendChild(script);
    }
</script>
</body>
</html>
